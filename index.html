<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Full Image Editor</title>
<style>
body{
  background:#111;
  color:white;
  font-family:Arial;
  text-align:center;
}
.controls{
  margin:15px;
}
canvas{
  border:2px solid white;
  margin-top:10px;
  max-width:90%;
}
input,button{
  margin:6px;
}
</style>
</head>
<body>

<h2>Full Image Editor</h2>

<div class="controls">

<input type="file" id="upload" accept="image/*"><br>

<label>Background:
<input type="color" id="bgColor" value="#000000">
</label>

<label>Outline Size:
<input type="range" id="outlineSize" min="0" max="50" value="0">
</label>

<label>Outline Color:
<input type="color" id="outlineColor" value="#ffffff">
</label>

<br>

<label>
<input type="checkbox" id="rainbowToggle">
Rainbow Overlay
</label>

<br>

<label>Output Quality (JPEG):
<input type="range" id="quality" min="0.1" max="1" step="0.1" value="1">
</label>

<br>

<button onclick="downloadPNG()">Download PNG</button>
<button onclick="downloadJPG()">Download JPG</button>

</div>

<canvas id="canvas"></canvas>

<script>
const upload = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const bgColor = document.getElementById("bgColor");
const outlineSize = document.getElementById("outlineSize");
const outlineColor = document.getElementById("outlineColor");
const rainbowToggle = document.getElementById("rainbowToggle");
const qualitySlider = document.getElementById("quality");

let img = new Image();

upload.addEventListener("change", e=>{
  const file = e.target.files[0];
  if(!file) return;

  const reader = new FileReader();
  reader.onload = ev=>{
    img.onload = ()=>{
      canvas.width = img.width;
      canvas.height = img.height;
      draw();
    }
    img.src = ev.target.result;
  }
  reader.readAsDataURL(file);
});

[bgColor, outlineSize, outlineColor, rainbowToggle].forEach(el=>{
  el.addEventListener("input", draw);
});

function draw(){
  if(!img.src) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Background
  ctx.fillStyle = bgColor.value;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Outline
  if(outlineSize.value > 0){
    ctx.save();
    ctx.lineWidth = outlineSize.value;
    ctx.strokeStyle = outlineColor.value;
    ctx.strokeRect(0,0,canvas.width,canvas.height);
    ctx.restore();
  }

  // Image
  ctx.drawImage(img,0,0);

  // Rainbow overlay
  if(rainbowToggle.checked){
    const gradient = ctx.createLinearGradient(0,0,canvas.width,0);
    gradient.addColorStop(0,"red");
    gradient.addColorStop(0.16,"orange");
    gradient.addColorStop(0.33,"yellow");
    gradient.addColorStop(0.5,"green");
    gradient.addColorStop(0.66,"blue");
    gradient.addColorStop(0.83,"indigo");
    gradient.addColorStop(1,"violet");

    ctx.globalAlpha = 0.4;
    ctx.fillStyle = gradient;
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.globalAlpha = 1;
  }
}

function downloadPNG(){
  const link = document.createElement("a");
  link.download = "edited.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}

function downloadJPG(){
  const q = parseFloat(qualitySlider.value);
  const link = document.createElement("a");
  link.download = "edited.jpg";
  link.href = canvas.toDataURL("image/jpeg", q);
  link.click();
}
</script>

</body>
</html>
